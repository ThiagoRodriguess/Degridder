/**
 * @file Core0.c
 * @generated by CPrinter
 * @date Tue Jun 17 09:53:56 CEST 2025
 *
 * Code generated for processing element Core0 (ID=0).
 */

#include "preesm_gen.h"
// Core Global Declaration
extern pthread_barrier_t iter_barrier;
extern int preesmStopThreads;

#ifdef PREESM_MD5_UPDATE
extern struct rk_sema preesmPrintSema;
#endif

// Core Global Definitions
char Shared[201866032]; //  size:= 201866032*char
char *const fft_shift_real_to_complex_actor_0__CUFFT_EXECUTE_FORWARD_C__0 = (char*) (Shared + 0); // fft_shift_real_to_complex_actor_0 > CUFFT_EXECUTE_FORWARD_C2C_actor_0 size:= 52428800*char
char *const CUFFT_EXECUTE_FORWARD_C2C_actor_0__fft_shift_complex_to_co__0 = (char*) (Shared + 52428800); // CUFFT_EXECUTE_FORWARD_C2C_actor_0 > fft_shift_complex_to_complex_actor_0 size:= 52428800*char
char *const fft_shift_complex_to_complex_actor_0__degridder_parallel_0__0 = (char*) (Shared + 0); // fft_shift_complex_to_complex_actor_0 > degridder_parallel_0_Degridder_0 size:= 52428800*char
char *const visibility_host_set_up_0__broadcast_vis_uvw_coords_0__0 = (char*) (Shared + 104857608); // visibility_host_set_up_0 > broadcast_vis_uvw_coords_0 size:= 47093760*char
char *const broadcast_vis_uvw_coords_0__degridder_parallel_0_Degridder__0 = (char*) (Shared + 104857608); // broadcast_vis_uvw_coords_0 > degridder_parallel_0_Degridder_0 size:= 47093760*char
char *const broadcast_vis_uvw_coords_0__convert_vis_to_csv_0__0 = (char*) (Shared + 151951368); // broadcast_vis_uvw_coords_0 > convert_vis_to_csv_0 size:= 47093760*char
char *const degridder_parallel_0_Degridder_0__convert_vis_to_csv_0__0 = (char*) (Shared + 52428800); // degridder_parallel_0_Degridder_0 > convert_vis_to_csv_0 size:= 31395840*char
char *const load_image_from_file_0__fft_shift_real_to_complex_actor_0__0 = (char*) (Shared + 52428800); // load_image_from_file_0 > fft_shift_real_to_complex_actor_0 size:= 26214400*char
char *const generate_kernels_0__degridder_parallel_0_Degridder_0__0 = (char*) (Shared + 199045128); // generate_kernels_0 > degridder_parallel_0_Degridder_0 size:= 2820232*char
char *const config_struct_set_up_0__broadcast_config_0__0 = (char*) (Shared + 201865424); // config_struct_set_up_0 > broadcast_config_0 size:= 304*char
char *const broadcast_config_0__degridder_parallel_0_Degridder_0__0 = (char*) (Shared + 201865424); // broadcast_config_0 > degridder_parallel_0_Degridder_0 size:= 304*char
char *const broadcast_config_0__visibility_host_set_up_0__0 = (char*) (Shared + 201865424); // broadcast_config_0 > visibility_host_set_up_0 size:= 304*char
char *const broadcast_config_0__convert_vis_to_csv_0__0 = (char*) (Shared + 201865728); // broadcast_config_0 > convert_vis_to_csv_0 size:= 304*char
char *const broadcast_config_0__fft_shift_real_to_complex_actor_0__0 = (char*) (Shared + 78643280); // broadcast_config_0 > fft_shift_real_to_complex_actor_0 size:= 304*char
char *const broadcast_config_0__load_image_from_file_0__0 = (char*) (Shared + 0); // broadcast_config_0 > load_image_from_file_0 size:= 304*char
char *const degridder_parallel_0_iterator_0__degridder_parallel_0_Degr__0 = (char*) (Shared + 104857600); // degridder_parallel_0_iterator_0 > degridder_parallel_0_Degridder_0 size:= 4*char
float2 *const fourier__uv_grid_in__0 = (float2*) (Shared + 0); // fft_shift_real_to_complex_actor_0_fourier > CUFFT_EXECUTE_FORWARD_C2C_actor_0_uv_grid_in size:= 6553600*float2
float2 *const uv_grid_out__uv_grid_in__0 = (float2*) (Shared + 52428800); // CUFFT_EXECUTE_FORWARD_C2C_actor_0_uv_grid_out > fft_shift_complex_to_complex_actor_0_uv_grid_in size:= 6553600*float2
float2 *const uv_grid_out__input_grid__0 = (float2*) (Shared + 0); // fft_shift_complex_to_complex_actor_0_uv_grid_out > degridder_parallel_0_Degridder_0_input_grid size:= 6553600*float2
float3 *const vis_uvw_coords__vis_uvw_coords__0 = (float3*) (Shared + 104857608); // visibility_host_set_up_0_vis_uvw_coords > broadcast_vis_uvw_coords_0_vis_uvw_coords size:= 3924480*float3
float3 *const degridder_0__vis_uvw_coords__0 = (float3*) (Shared + 104857608); // broadcast_vis_uvw_coords_0_degridder_0 > degridder_parallel_0_Degridder_0_vis_uvw_coords size:= 3924480*float3
float3 *const vis_to_csv_1__vis_uvw_coords__0 = (float3*) (Shared + 151951368); // broadcast_vis_uvw_coords_0_vis_to_csv_1 > convert_vis_to_csv_0_vis_uvw_coords size:= 3924480*float3
float2 *const output_visibilities__output_visibilities__0 = (float2*) (Shared + 52428800); // degridder_parallel_0_Degridder_0_output_visibilities > convert_vis_to_csv_0_output_visibilities size:= 3924480*float2
float *const output__input_grid__0 = (float*) (Shared + 52428800); // load_image_from_file_0_output > fft_shift_real_to_complex_actor_0_input_grid size:= 6553600*float
float2 *const kernels__kernels__0 = (float2*) (Shared + 199045128); // generate_kernels_0_kernels > degridder_parallel_0_Degridder_0_kernels size:= 352512*float2
int2 *const kernel_supports__kernel_supports__0 = (int2*) (Shared + 201865224); // generate_kernels_0_kernel_supports > degridder_parallel_0_Degridder_0_kernel_supports size:= 17*int2
Config *const config_struct__input__0 = (Config*) (Shared + 201865424); // config_struct_set_up_0_config_struct > broadcast_config_0_input size:= 1*Config
Config *const degridder_0__config__0 = (Config*) (Shared + 201865424); // broadcast_config_0_degridder_0 > degridder_parallel_0_Degridder_0_config size:= 1*Config
Config *const visibility_host_setup_1__config__0 = (Config*) (Shared + 201865424); // broadcast_config_0_visibility_host_setup_1 > visibility_host_set_up_0_config size:= 1*Config
Config *const vis_to_csv_2__config__0 = (Config*) (Shared + 201865728); // broadcast_config_0_vis_to_csv_2 > convert_vis_to_csv_0_config size:= 1*Config
Config *const fft_real_to_complex_3__config__0 = (Config*) (Shared + 78643280); // broadcast_config_0_fft_real_to_complex_3 > fft_shift_real_to_complex_actor_0_config size:= 1*Config
Config *const load_image_from_file_4__config__0 = (Config*) (Shared + 0); // broadcast_config_0_load_image_from_file_4 > load_image_from_file_0_config size:= 1*Config
int *const out__iterator__0 = (int*) (Shared + 104857600); // degridder_parallel_0_iterator_0_out > degridder_parallel_0_Degridder_0_iterator size:= 1*int

void* computationThread_Core0(void *arg) {
  if (arg != NULL) {
    printf("Warning: expecting NULL arguments\n");
    fflush (stdout);
  }

#ifdef PREESM_MD5_UPDATE
	PREESM_MD5_CTX preesm_md5_ctx_vis_to_csv_1__vis_uvw_coords__0;
	PREESM_MD5_Init(&preesm_md5_ctx_vis_to_csv_1__vis_uvw_coords__0);
	PREESM_MD5_CTX preesm_md5_ctx_vis_to_csv_2__config__0;
	PREESM_MD5_Init(&preesm_md5_ctx_vis_to_csv_2__config__0);
	PREESM_MD5_CTX preesm_md5_ctx_output_visibilities__output_visibilities__0;
	PREESM_MD5_Init(&preesm_md5_ctx_output_visibilities__output_visibilities__0);
#endif
  // Initialisation(s)

  // Begin the execution loop
  pthread_barrier_wait(&iter_barrier);
#ifdef PREESM_LOOP_SIZE // Case of a finite loop
	int index;
	for(index=0;index<PREESM_LOOP_SIZE && !preesmStopThreads;index++){
#else // Default case of an infinite loop
  while (!preesmStopThreads) {
#endif
    // loop body
    config_struct_set_up(2560/*GRID_SIZE*/, 17/*NUM_KERNELS*/, 1/*NUM_SCENARIO*/, config_struct__input__0); // config_struct_set_up_0

    iterator(3924480/*NUM_VISIBILITIES*/, 1/*NUM_CHUNK*/, out__iterator__0); // degridder_parallel_0_iterator_0

    generate_kernel(17/*NUM_KERNELS*/, 16/*OVERSAMPLING_FACTOR*/, 8/*NUM_KERNEL_SUPPORT*/,
        352512/*TOTAL_KERNELS_SAMPLES*/, kernels__kernels__0, kernel_supports__kernel_supports__0); // generate_kernels_0

    // Broadcast broadcast_config_0

    {
      // memcpy #0
      // memcpy #0
      // memcpy #0
      memcpy(vis_to_csv_2__config__0 + 0, config_struct__input__0 + 0, 304); // 1 * Config
      // memcpy #0
      memcpy(fft_real_to_complex_3__config__0 + 0, config_struct__input__0 + 0, 304); // 1 * Config
      // memcpy #0
      memcpy(load_image_from_file_4__config__0 + 0, config_struct__input__0 + 0, 304); // 1 * Config
    }

    load_image_from_file(2560/*GRID_SIZE*/, load_image_from_file_4__config__0, output__input_grid__0); // load_image_from_file_0

    visibility_host_set_up2(3924480/*NUM_VISIBILITIES*/, visibility_host_setup_1__config__0,
        vis_uvw_coords__vis_uvw_coords__0); // visibility_host_set_up_0

    // Broadcast broadcast_vis_uvw_coords_0

    {
      // memcpy #0
      // memcpy #0
      memcpy(vis_to_csv_1__vis_uvw_coords__0 + 0, vis_uvw_coords__vis_uvw_coords__0 + 0, 47093760); // 3924480 * float3
    }

    fft_shift_real_to_complex_actor(2560/*GRID_SIZE*/, output__input_grid__0, fft_real_to_complex_3__config__0,
        fourier__uv_grid_in__0); // fft_shift_real_to_complex_actor_0

    CUFFT_EXECUTE_FORWARD_C2C_actor(2560/*GRID_SIZE*/, fourier__uv_grid_in__0, uv_grid_out__uv_grid_in__0); // CUFFT_EXECUTE_FORWARD_C2C_actor_0

    fft_shift_complex_to_complex_actor(2560/*GRID_SIZE*/, uv_grid_out__uv_grid_in__0, uv_grid_out__input_grid__0); // fft_shift_complex_to_complex_actor_0

    std_degridding_parallel(2560/*GRID_SIZE*/, 3924480/*NUM_VISIBILITIES*/, 17/*NUM_KERNELS*/,
        352512/*TOTAL_KERNELS_SAMPLES*/, 16/*OVERSAMPLING_FACTOR*/, 1/*NUM_CHUNK*/, kernels__kernels__0,
        kernel_supports__kernel_supports__0, uv_grid_out__input_grid__0, degridder_0__vis_uvw_coords__0,
        degridder_0__config__0, out__iterator__0, output_visibilities__output_visibilities__0); // degridder_parallel_0_Degridder_0

    convert_vis_to_csv(3924480/*NUM_VISIBILITIES*/, output_visibilities__output_visibilities__0,
        vis_to_csv_1__vis_uvw_coords__0, vis_to_csv_2__config__0); // convert_vis_to_csv_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_vis_to_csv_1__vis_uvw_coords__0,(char *)vis_to_csv_1__vis_uvw_coords__0, 47093760);
		PREESM_MD5_Update(&preesm_md5_ctx_vis_to_csv_2__config__0,(char *)vis_to_csv_2__config__0, 304);
		PREESM_MD5_Update(&preesm_md5_ctx_output_visibilities__output_visibilities__0,(char *)output_visibilities__output_visibilities__0, 31395840);
		#endif

    // loop footer
    pthread_barrier_wait(&iter_barrier);

  }

#ifdef PREESM_MD5_UPDATE
	// Print MD5
	rk_sema_wait(&preesmPrintSema);
	unsigned char preesm_md5_chars_final[20] = { 0 };
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_vis_to_csv_1__vis_uvw_coords__0);
	printf("preesm_md5_vis_to_csv_1__vis_uvw_coords__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_vis_to_csv_2__config__0);
	printf("preesm_md5_vis_to_csv_2__config__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_output_visibilities__output_visibilities__0);
	printf("preesm_md5_output_visibilities__output_visibilities__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	rk_sema_post(&preesmPrintSema);
#endif

  return NULL;
}

